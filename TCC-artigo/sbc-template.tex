\documentclass[12pt]{article}

\usepackage{sbc-template}

\usepackage{graphicx,url}
\usepackage{listings}

\usepackage[brazil]{babel}   
\usepackage[latin1]{inputenc}  

     
\sloppy

\title{Protótipo de Jogo Digital para Pessoas com Deficiência Motora Usando OpenCV e Pygame}

\author{Vinicius Bordinhão\inst{1}, Dr. Eduardo Filgueiras Damasceno\inst{1} }


\address{Universidade Tecnológica Federal do Paraná
  (UTFPR)\\
  Cornélio Procópio -- PR -- Brazil
  \email{viniciusbord9@gmail.com, }
}

\begin{document} 

\maketitle

\begin{abstract}
  This article has the main goal of exemplify the use of digital games on motor recuperation of disabled people . Through of OpenCL is possible to build new iterations between users and digital games , without to the use of joysticks or keyboards, making the main focus of the digital game the recuperation of mobility of patient with entertainment
\end{abstract}
     
\begin{resumo} 
 Este artigo tem o objetivo principal de exemplificar a utilização dos jogos digitais na recuperação motora de pessoas com deficiência. Através de OpenCL é possível construir novas iterações entre usuários e jogos digitais, sem o uso de joysticks ou teclados, tornando o foco principal do jogo digital, a recuperação da mobilidade do paciente com entretenimento
\end{resumo}


\section{Introdução}
Jogos digitais tem sido utilizados normalmente como forma de entretenimento e o seu consume tem crescido ano após ano, tornando possível o desenvolvimento de novas formas de interação
entre usuários e jogos digitais.

Grandes empresas tem desenvolvidos dispositivos para interação dos jogadores com os jogos digitais tais como: Kinect da Microsoft e o Leap Motion\cite{altanis:13}.

Essas ferramentas tem proporcionado uma interação gestual entre usuários e máquinas, substituindo em alguns casos,  completamente periféricos mais tradicionais como teclado, mouse e joysticks. Esses periféricos necessitam que o usuário tenha uma boa coordenação motora para plena utilização, o que reduz ou até mesmo exclui pessoas com deficiência motora.

Com o uso da biblioteca OpenCV é possível construir aplicações que possuam interação gestual com o usuário usando dispositivos simples como câmeras de vídeo com a vantagem de estar disponível para um grande numero sistemas operacionais desktops como, Windows, Linux, Android, MacOS, FreeBSD, OpenBSD e mobile como Android, Maemo e iOS, além de poder ser usada em diversas linguagens de programação tais quais C, Python e Java.[fjdksafjdksaçfda]

Nesse trabalho será descrito o processo de desenvolvimento de um protótipo de jogo digital utilizando a captura de movimento de câmera digital como forma de interação para jogador.
Atualmente grande partes dos dispositivos possui uma câmera digital com capacidade suficiente para capturar movimentos e possibilitar ao usuário uma interação sem contato direto com a tela, ou teclado do dispositivo. Devido a disponibilidade dos dispositivos móveis é possível disponibilizar esse recurso na recuperação motora de pessoas com necessidade de readquirir a mobilidade perdida.

Como a biblioteca OpenCV já possui uma interface pronta para integração com a linguagem Python,
o uso do Pygame para o desenvolvimento desse protótipo seria o caminho mais rápido para atingir
os objetivos, pois a biblioteca Pygame proporciona grande facilidade no desenvolvimento de jogos digitais 2D, com rotinas e recursos construindo exclusivamente para esse fim. 

\section{Referêncial Teórico} \label{sec:firstpage}
Atualmente o mercado de jogos digitais tem evoluído e se tornado mais lucrativo que a indústria do cinema. Isso porque os jogos se tornaram complexos com histórias cada vez mais complexas e contínuas que oferecem uma imersão mais profunda que filmes, pois na história o jogador não é um agente passivo que apenas observa o desfecho da trama ele participa ativamente o que faz a estória não ser apenas contada, mas vivenciada pelo jogador.[Mapeamento da Indústria Brasileira e Global de Jogos
Digitais, 2014]

A forma de interação com jogos tem mudado com o passar do tempo, atualmente existem vários dispositivos que tem substituído os principais modelos de interação. A interação natural do usuário tem sido proposta através de alguns dispositivos como Microsoft Kinect, que pode detectar movimentos, gestos e transferi-los para um computador. Isso tem aberto novos caminhos para o a reabilitação e terapia de pessoas com deficiência motora \cite{chang:11}

Outro uso inovador de tecnologias de interação natural é no auxílio de crianças com dispraxia\footnote{Dispraxia é uma disfunção motora neurológica que impede o cérebro de desempenhar os movimentos corretamente.} aumentando a percepção visual e o planejamento e a execução dos movimentos usando tecnologias como Wii, Microsoft Kinect e Leap Motion\cite{altanis:13}.

Jogos digitais também são capazes de prender a atenção de estudantes com déficit cognitivo de maneira mais eficiente que outros conteúdos, sendo assim, a melhor concentração oferecida por eles pode ser estendida para pessoas que não tem problemas cognitivos, mas necessitam estar concentrados para ajudar, facilitar e acelerar a sua recuperação. [A Motion-Sensing Game-Based Therapy to Foster the Learning of Children with Sensory Integration Dysfunction]

Existe a possibilidade de usar todos os benefícios da apresentados anteriormente pelo uso de ferramentas de capturas de movimentos sem a necessidade de hardwares extras, pois a biblioteca OpenCV\footnote{Open Source Computer Vision Library} já fornece um conjunto de ferramentas para aprendizagem de máquina, que inclui vários algoritmos otimizados para detecção e reconhecimento de faces, identificação de objetos, classificação de ações humanas em vídeos, captura de movimentos por câmera, dentre outros\cite{opencv:12}

O foco principal do OpenCV na aplicação desenvolvida é a captura de movimentos por câmera, com isso o único hardware adicional é a própria câmera. Além disso, as únicas funções da biblioteca discutidas nesse artigo serão referentes à detecção de movimentos e os algoritmos que ela utiliza
para fazê-lo.

Para o desenvolvimento do jogo digital será usada a biblioteca Pygame que foi construida sobre outra biblioteca de desenvolvimento, a SDL\footnote{Simple DirectMedia Layer}. A SDL foi escrita na linguagem de programação C por Sam Lantinga e é capaz de fornecer um caminho comum entre plataformas para trabalhar com gráficos e dispositivos de entrada. Com a popularização da SDL foram sendos criados interfaces para outras linguagens e uma dessas interfaces originou o Pygame \cite{will:07}.

Tanto o Pygame quando SDL são de código aberto e um grande número de programadores tem trabalho para melhorar e difundir essas ferramentas, tornando assim possível desenvolver jogos digitais de maneira mais prática e fácil\cite{will:07}.

\section{Desenvolvimento}

O jogo conta com duas janelas, sendo que uma delas é a imagem da câmera onde será criado um monitor para captura de movimento que chamaremos de 'tracker'. Já na outra será exibido a interface gráfica do jogo, que não receberá nenhum tipo de entrada do usuário por qualquer dispositivo. O objetivo principal desse modelo é que a interação seja exclusivamente por meio natural, impedindo assim que ações externar prejudiquem a experiência do jogador que pressupõe 
estar realizando uma terapia com acompanhamento.

O jogo é do tipo plataforma em duas dimensões baseado no jogo Alien desenvolvido usando a biblioteca Pygame. O jogo é de código aberto e as rotinas desenvolvidas nesse projeto estão bem similares ao jogo original, com modificações pontuais para trabalhar com a captura de movimentos.

O tema original foi mantido, sendo assim, ele está ligado a alienígenas, que na versão original eram várias naves espaciais que bombardeiam um tanque de guerra que é o personagem controlado pelo jogador.

O movimentos possíveis tanto para o jogador quanto para a nave espacial são para direita e esquerda, sendo que o tanque fica na parte inferior da janela, enquanto a nave fica na parte superior como é mostrado na figura~\ref{fig:figura1}. A cada interação existe uma chance da nave lançar mísseis contra o tanque e caso este consiga esquivar um ponto é adicionado a sua pontuação. Conforme a pontuação do jogador eleva-se a chance de mais mísseis serem lançados pela nave, tornando o jogo mais difícil.

Ao executar a aplicação o jogo encontra-se pausado, até que o usuário crie uma região de captura na janela onde a câmera está sendo exibida. Assim que o objeto é criado o jogo inicia, e o jogador pode movimentar o tanque fazendo um movimento natural que está sendo monitorado na região de captura.  

\begin{figure}[ht]
	\centering
	\includegraphics[width=.5\textwidth]{figura1.png}
	\caption{Interface gráfica do jogo digital}
	\label{fig:figura1}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics[width=.5\textwidth]{figura2.png}
	\caption{Interface gráfica da câmera}
	\label{fig:figura2}
\end{figure}


\subsection{Implementação}

Para iniciar jogos usando o Pygame é necessário inicializá-la e posteriormente fazer os carregamentos necessários de imagens, sons, e posteriormente injetá-los nos elementos do jogo. Nessa implementação os objetos que controlam as sequencias de imagens - também conhecidos nos jogos 2D como sprites - foram separados em classes para melhor organização do projeto.

Na listagem \ref{carregamento-media} é possível verificar a implementação do carregamento das imagens e sons junto com a incorporação das mídias nos objetos.

Após fazer o carregamento do arquivos foi criado uma interação sem parada definida para a execução da jogo e também da ferramenta de captura de movimentos. Enquanto o tanque - que é o elemento controlado pelo jogador - não colidir com nenhum míssil enviado pela nave. Dentro da interação são verificados as colisões dos objetos através de funções fornecidas pelo Pygame e também verificando a posição da região de captura sofreu alteração como pode ser observado na listagem \ref{interacao-principal}




\lstset{language=Python,frame=single,basicstyle=\footnotesize,caption={Carregamento de mídia},label=carregamento-media}
\begin{lstlisting}
    
#Carregando imagens e colocando na classe respectiva.
img = load_image('tank.gif')
Player.images = [img, pygame.transform.flip(img, 1, 0)]
img = load_image('explosion1.gif')
Explosion.images = [img, pygame.transform.flip(img, 1, 1)]
Alien.images = load_images('alien1.gif', 'alien2.gif', 'alien3.gif')
Bomb.images = [load_image('bomb.gif')]
Shot.images = [load_image('shot.gif')]
...
#Criando background do jogo
bgdtile = load_image('background.gif')
background = pygame.Surface(SCREENRECT.size)
for x in range(0, SCREENRECT.width, bgdtile.get_width()):
 background.blit(bgdtile, (x, 0))
 screen.blit(background, (0,0))
 pygame.display.flip()

#Carregando efeitos de som
boom_sound = load_sound('boom.wav')
shoot_sound = load_sound('car_door.wav')
if pygame.mixer:
music = os.path.join(main_dir, 'data', 'house_lo.wav')
pygame.mixer.music.load(music)
pygame.mixer.music.play(-1)
...

\end{lstlisting}

\lstset{language=Python,frame=single,basicstyle=\footnotesize,tabsize=2,caption={Carregamento de mídia},label=interacao-principal}
\begin{lstlisting}
while player.alive():
	capture.run(); #inicializando captura opencv
	if(len(capture.trackers) > 0):
		old_pos = current_pos;
		current_pos = capture.trackers[0].pos
		
		if(old_pos[0] > current_pos[0]):
			direction = 1
		elif(old_pos[0] < current_pos[0]):
			direction = -1
		else:
			direction = 0
		
		# Limpa e atualiza os ultimos sprites desenhados
		all.clear(screen, background)
		
		# Atualizando sprites
		all.update()
		
		player.move(direction)
		
		# Mísseis
		if lastalien and not int(random.random() * BOMB_ODDS):
		Bomb(lastalien.sprite)
		
		# Detecção de colisão		
		for alien in pygame.sprite.groupcollide(shots, aliens, 1, 1).keys():
			boom_sound.play()
			Explosion(alien)
		
		for bomb in pygame.sprite.spritecollide(player, bombs, 1):
			boom_sound.play()
			Explosion(player)
			Explosion(bomb)
			player.kill()
		
		#Redesenhando a cena
		dirty = all.draw(screen)
		pygame.display.update(dirty)
		
		# Framerate
		clock.tick(40)

\end{lstlisting}






\section{Conclusão}


\subsection{Subsections}


\section{Figures and Captions}\label{sec:figs}


Figure and table captions should be centered if less than one line
(Figure~\ref{fig:exampleFig1}), otherwise justified and indented by 0.8cm on
both margins, as shown in Figure~\ref{fig:exampleFig2}. The caption font must
be Helvetica, 10 point, boldface, with 6 points of space before and after each
caption.

\begin{figure}[ht]
\centering
\includegraphics[width=.5\textwidth]{fig1.jpg}
\caption{A typical figure}
\label{fig:exampleFig1}
\end{figure}

\begin{figure}[ht]
\centering
\includegraphics[width=.3\textwidth]{fig2.jpg}
\caption{This figure is an example of a figure caption taking more than one
  line and justified considering margins mentioned in Section~\ref{sec:figs}.}
\label{fig:exampleFig2}
\end{figure}

In tables, try to avoid the use of colored or shaded backgrounds, and avoid
thick, doubled, or unnecessary framing lines. When reporting empirical data,
do not use more decimal digits than warranted by their precision and
reproducibility. Table caption must be placed before the table (see Table 1)
and the font used must also be Helvetica, 10 point, boldface, with 6 points of
space before and after each caption.

\begin{table}[ht]
\centering
\caption{Variables to be considered on the evaluation of interaction
  techniques}
\label{tab:exTable1}
\includegraphics[width=.7\textwidth]{table.jpg}
\end{table}

\section{Images}



\bibliographystyle{sbc}
\bibliography{sbc-template}

\end{document}
